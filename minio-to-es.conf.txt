input {
  s3 {
    bucket => "parsed-indexed"
    access_key_id => "minioadmin"
    secret_access_key => "minioadmin"
    endpoint => "http://localhost:9000" 
    region => "us-east-1"

    # MinIO compatibility settings (keep these)
    additional_settings => {
      "force_path_style" => true
      "use_dualstack_endpoint" => false
      "use_accelerate_endpoint" => false
      "follow_redirects" => false
    }

    prefix => ""
    sincedb_path => "/tmp/logstash_sincedb"
    temporary_directory => "/tmp/logstash-s3"  
    codec => "json"  # Or "json_lines", "plain", etc., based on your files
    watch_for_new_files => true
    interval => 60  # Poll every 60 seconds (adjust as needed)
  }
}

filter {
  json {
    source => "message"
  }
}

output {
  elasticsearch {
    hosts => ["http://localhost:9200"]
    index => "minio-data-%{+YYYY.MM.dd}" 
    user => "elastic"  # If ES has security enabled; otherwise omit
    password => "your_es_password"  
  }
  stdout { codec => rubydebug }
}
